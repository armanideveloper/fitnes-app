"use strict";(self["webpackChunkfitness_app"]=self["webpackChunkfitness_app"]||[]).push([[464],{6060:function(t,e,s){s.d(e,{Z:function(){return _}});var a=function(){var t=this,e=t._self._c;return e("header",{staticClass:"base-page-header",class:{"base-page-header--items-start":t.itemsStart}},[e("go-back-btn",{staticClass:"base-page-header__go-back",attrs:{"back-to":t.backTo}}),e("h1",{staticClass:"base-page-header__title"},[t._t("default")],2)],1)},n=[],i=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"go-back-btn",attrs:{to:{name:t.backTo}}},[e("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{d:"M15.5 19C15.5 19 8.5 14.856 8.5 12C8.5 9.145 15.5 5 15.5 5",stroke:"#031418","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}})])])},o=[],r={name:"GoBackBtn",props:{backTo:{type:String,required:!0,default:"Home"}}},c=r,u=s(1001),l=(0,u.Z)(c,i,o,!1,null,"4f2d44d7",null),p=l.exports,m={name:"BasePageHeader",components:{GoBackBtn:p},props:{backTo:{type:String,default:"Home"},itemsStart:{type:Boolean,default:!1}}},d=m,h=(0,u.Z)(d,a,n,!1,null,null,null),_=h.exports},5297:function(t,e,s){s.r(e),s.d(e,{default:function(){return _}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pt-42 store-payment"},[e("div",{staticClass:"container"},[e("base-page-header",{attrs:{"back-to":t.backTo}},[t._v("Payment")]),e("div",{staticClass:"store-payment__about payment-about"},[e("p",{staticClass:"payment-about__text"},[t._v(" You are about to pay "),e("br"),e("strong",[t._v(t._s(t.totalPrice)+" RON")]),t.isDiscountApplied?e("span",[t._v("Â (discount applied)")]):t._e(),e("br"),t._v(" to "),e("strong",[t._v("Company Ltd.")]),e("br"),t._v(" for "),e("strong",[t._v(t._s(t.paymentPurpose))])]),t._m(0),e("hr"),e("p",{staticClass:"payment-about__security"},[t._v(" Secure payment with "),e("img",{attrs:{src:s(9484),alt:""}})])]),e("div",{staticClass:"payment-about__discount discount"},[e("div",{staticClass:"discount__wrapper"},[e("label",{staticClass:"discount__label",attrs:{for:"discount"}},[t._v("Apply discount")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedDiscount,expression:"selectedDiscount"}],staticClass:"discount__select",attrs:{name:"discount",id:"discount"},on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedDiscount=e.target.multiple?s:s[0]}}},[e("option",{attrs:{disabled:"",value:"0"}},[t._v("Discount")]),t._l(t.discounts,(function(s,a){return e("option",{key:`discount-option_${a}`,domProps:{value:s}},[t._v(" "+t._s(s)+" ")])}))],2)]),e("button",{staticClass:"discount__btn",on:{click:t.applyDiscount}},[t._v("Apply")])]),e("div",{staticClass:"store-payment__buttons"},[e("base-button",{staticClass:"base-btn base-btn--white store-payment__btn",nativeOn:{click:function(e){return t.cancelPaymentHandler.apply(null,arguments)}}},[t._v(" Cancel payment ")]),e("base-button",{staticClass:"base-btn store-payment__btn",nativeOn:{click:function(e){return t.paymentClickHandler.apply(null,arguments)}}},[t._v("Go to payment")])],1)],1)])},n=[function(){var t=this,e=t._self._c;return e("p",{staticClass:"payment-about__availability"},[t._v(" Your purchase will be available at "),e("strong",[t._v("Moovgym")]),t._v(" location or "),e("strong",[t._v("Partner locations")])])}],i=(s(7658),s(3822)),o=s(5729),r=s(5879),c=s(6565);const u=(t=5e3)=>new Promise((e=>setTimeout(e,t)));var l=s(6060),p={name:"StorePaymentView",components:{BaseButton:r.Z,BasePageHeader:l.Z},metaInfo:{title:"Payment"},data(){return{backTo:"Store",discount:0,isDiscountApplied:!1,inBrowser:null,ref:{}}},created(){this.inBrowser="undefined"!==typeof window},computed:{...(0,i.Se)({user:o.Z.USER_DATA,planForBuying:o.Z.PLAN_FOR_BUYING}),paymentPurpose(){return this.planForBuying?.name},initialPrice(){return+this.planForBuying?.price},discounts(){const t=+this.user.member.reward_points;if(t>=100){const e=Math.floor(t/100);return[...Array(e)].map(((t,e)=>10*(e+1)))}return null},selectedDiscount:{get(){return this.discount},set(t){this.discount=t,this.isDiscountApplied=!1}},totalPrice(){return this.isDiscountApplied?this.initialPrice-this.discount:this.initialPrice}},methods:{applyDiscount(){this.discount&&(this.isDiscountApplied=!0)},paymentClickHandler(){const t=this,e=Date.now();t.inBrowser&&this.openWindow(e),t.checkPayment(e,(e=>{t.processMessageData(JSON.parse(e))}))},openWindow(t){const e=`https://gymon.io/payment/checkoutdev.php?&user=${this.user.id}&live=0&amount=${this.totalPrice}&rand=${t}`;this.ref=window.open(e,"_blank")},checkWindow(){return this.ref&&!this.ref.closed},checkPayment(t,e){const s=this;try{c.Z.get(`/check_payment?user=${s.user.id}&rand=${t}`).then((a=>{a.data.status?e(a.data):s.inBrowser?this.checkWindow()?window.check_payment_timeout=setTimeout((function(){s.checkPayment(t,e)}),2e3):(s.$toaster.info("Cancel check payment"),clearTimeout(window.check_payment_timeout)):window.check_payment_timeout=setTimeout((function(){s.checkPayment(t,e)}),2e3)}))}catch(a){s.inBrowser?this.checkWindow()?window.check_payment_timeout=setTimeout((function(){s.checkPayment(t,e)}),2e3):clearTimeout(window.check_payment_timeout):window.check_payment_timeout=setTimeout((function(){s.checkPayment(t,e)}),2e3)}},processMessageData(t){t&&t.message&&t.channel&&(this.ref&&this.ref.close&&this.ref.close(),"succeeded"===t.message||"processing"===t.message?this.processPayment(t):this.$toaster.info(t.msg))},async processPayment(t){try{await u();const e=await c.Z.get(`/plan?discount=${this.discountSelected||0}&charge=1&plan=${t.charge.id}&start_date=${this.planForBuying.start_date}&user=${this.user.id}&member=${this.user.member.id}&registration=${this.user.registration.id}`);e.status?(this.$toaster.success("Plata a fost efectuata cu success"),setTimeout((()=>{this.$router.push({name:"StorePaymentSuccess"})}),2e3)):this.$toaster.error(e.data.message)}catch(e){this.$toaster.error("Communication error")}},cancelPaymentHandler(){window.check_payment_timeout&&clearTimeout(window.check_payment_timeout),this.$router.push({name:"Store"})}}},m=p,d=s(1001),h=(0,d.Z)(m,a,n,!1,null,"40fccb19",null),_=h.exports},9484:function(t){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAVCAYAAAAElr0/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATWSURBVHgBvVddTFxFFP7m7l0KWFqQ0qS0QSiW9EdNikZsghFNfdAYbWywLAt2gY3GF2NfjOmDLb600cYaXzRYKIXFNhIeTNWmmvTBv5pqY9SkwYoraSONUmhLaCq77B6/2d17ubuherdl+cIwZ849M3O+MzNnZhVyiMA2Kfbk41kY2ASFuqkIHhscVBHkAGY2xoEGyZcybDoyqM66sTfuQIDVQSwCXBFp98sTSvAGxfWM7BXWFcgSIhDkEIZLu40k8ADLUspxl32g4hhWCp0eAw/PmijL1bbSsFekdYds8BrYSmdLEwrBOZave46pMSPRnPOvrVm2puSwEcXVuBe1iVYMkzKDsFkIX1zh92gEvxhaCxSwrm1slFOFJtaT3F3anATPYwaTMS9a+b1EAcOeXzHUdVZFMx1tf1qKVBEe5MrWax9E4YfDA+oT26mGBjGr1+A9ehrEfEwFNbPAMyT4VuY3DtqpPBjmGh1NqcZYdNQrOd4XnOwz5TgjPOxLlproMgzsTAXrR45bTWmZY9hRrxePvt+rRi1FR6vcw609xPlqMlwYicXweO8xNWpUr8aem5HQ+EeQB/coT5BwC4XNSCehURmN4vNAQIp1I9AklQzUyXlIaNxteDCkF4MBR6NKaSmPsjrOdh7lataJLcRBlFK2zRQdOK5lQ/Az23nzOHie//+EO3zJEuY4DWouCOs8kURwD5gmOjl/eWrui7TZzzrK+k2qilnXrl2DZpN7s1rs+fFV94B62ZpBRyOiMF2Q5iMmukOqxWpz2ZucXsUF27h3P9Yys90r+G/8wfke0cILLbIqngzMipTTT2kiJOG3jOnr7kMDKqTloE9KxcA+JI0bTRp+R+/qU7atHS1ST10XO4XYaTThkM995mTCOAP3sDYDukLqEucJKQMJ8twBW9jeQtFj2dCv2jafrE3ICvc5xtlscKjXKEzaKkEVR99Hw5Fgs+zFIoIkfnM080ihLN0Au5goOnWhvH1OjZUGl/Ybnvz72T7Ccs3uJFhCMns6fPKiGHORyyUknn7wjSzmTdwjOn2xCugF6/CjDcmUmRiU6fU5kjppT+b+Es0ahsIGaxMziH/HZ3kPOajILJ68NIVT8/Ztb5Gj3Hc7X2qWEn3PeIbRz5xtLzH3pZc3tH1IyGJ1sFWqtOz3yzLcHooDzbJOux30Swudf976wDlPH/5Qhcnjsq0z8fqq5Sg9cULN6KJ1K4tQV16GjSZTaA23TpO+xTjYhZjwGaJwp2OyMNvjNjG9inGEO/xyhSTfpWoYt45iD1M1dwGvK+Q7P/DW/yAl7mc5kJIf4g65yOB/T0cKGfAq/WxSs9ietk1EPwYdJPS9wvOzN+rBIJsXMpwowcIhjQRX4R1msU+1fGgAb3OlPnJ8Nkigjjb3pt5+SSWd1VH9yTkQI32DLPrVDTTo89Pfr67z2aDz/RmHDf8wZsQxzfovq6S5F8N1JHVWycRVJJOMhWtMu68WRbDbQUt6QmoH9e10fiSj/wTJHGRSOJ2WFXw+WUGHpa9PTeAm2NUoBZfzUdTXh3Fe91k/zXkee+23FlecWbNKhGckiJLubjX5f/31c6SiAsvHxzFtnRONRUmrTsxHBAuAnKVSN5AF/KmV1U/dBYHiuYijh7f4ORL5FguEfwH+Da1/mQm8aQAAAABJRU5ErkJggg=="}}]);
//# sourceMappingURL=store-payment.ab823618.js.map